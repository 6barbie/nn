clc;
clear all;
close all;
X = zeros(5, 5, 4); 
X(:, :, 1) = [ 
0 1 1 0 0;
0 0 1 0 0;
0 0 1 0 0;
0 0 1 0 0;
0 1 1 1 0
];
X(:, :, 2) = [ 
1 1 1 1 0;
0 0 0 0 1;
0 1 1 1 0;
1 0 0 0 0;
1 1 1 1 1
];
X(:, :, 3) = [
1 1 1 1 0;
0 0 0 0 1;
0 1 1 1 0;
0 0 0 0 1;
1 1 1 1 0
];
X(:, :, 4) = [ 
0 0 0 1 0;
0 0 1 1 0;
0 1 0 1 0;
1 1 1 1 1;
0 0 0 1 0
];


D = [ 
1 0 0 0;
0 1 0 0;
0 0 1 0;
0 0 0 1;
]; 
W1 = 2*rand(50, 25) - 1;
W2 = 2*rand( 4, 50) - 1;

for epoch = 1:10000 % train
[W1, W2] = MultiClass(W1, W2, X, D);
end


N = 4; % inference  
for k = 1:N
    disp('---------------------------------------------------------');
    disp(k);
    disp(X(:, :, k));
    x = reshape(X(:, :, k), 25, 1);
    v1 = W1*x;
    y1 = Sigmoid(v1);
    v = W2*y1;
    y = Softmax(v)
end

